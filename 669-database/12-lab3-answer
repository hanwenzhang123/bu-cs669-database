Section One – Aggregating Data

Step 1 – Creating Table Structure and Data

CREATE TABLE Genre (
genre_id DECIMAL(12) NOT NULL PRIMARY KEY,
genre_name VARCHAR(64) NOT NULL
);

CREATE TABLE Creator (
creator_id DECIMAL(12) NOT NULL PRIMARY KEY,
first_name VARCHAR(64) NOT NULL
last_name VARCHAR(64) NOT NULL
);

CREATE TABLE Movie_series (
movie_series_id DECIMAL(12) NOT NULL PRIMARY KEY,
genre_id DECIMAL(12) NOT NULL,
creator_id DECIMAL(12) NOT NULL,
series_name VARCHAR(255) NOT NULL,
suggested_price DECIMAL(8,2) NULL,
FOREIGN KEY (genre_id) REFERENCES Genre(genre_id)
FOREIGN KEY (creator_id) REFERENCES Creator(creator_id)
);

CREATE TABLE Movie (
movie_id DECIMAL(12) NOT NULL PRIMARY KEY,
movie_series_id DECIMAL(12) NOT NULL,
movie_name VARCHAR(64) NOT NULL,
length_in_minutes DECIMAL(4),
FOREIGN KEY (movie_series_id) REFERENCES Movie_series(movie_series_id)
);

--Genre
INSERT INTO Genre(genre_id, genre_name)
VALUES(1, 'Fantasy');
INSERT INTO Genre(genre_id, genre_name)
VALUES(2, 'Family Film');
INSERT INTO Genre(genre_id, genre_name)
VALUES(3, 'Romance');
INSERT INTO Genre(genre_id, genre_name)
VALUES(4, 'Comedy');

--Creator
INSERT INTO Creator(creator_id, first_name, last_name)
VALUES(01, 'George', 'Lucas');
INSERT INTO Creator(creator_id, first_name, last_name)
VALUES(02, 'John', 'Lasseter');
INSERT INTO Creator(creator_id, first_name, last_name)
VALUES(03, 'John', 'Tolkien');
INSERT INTO Creator(creator_id, first_name, last_name)
VALUES(04, 'Jane', 'Doe');

--Movie_series
INSERT INTO Movie_series(movie_series_id, genre_id, creator_id, series_name, suggested_price)
VALUES(101, 1, 01, 'Star Wars', 129.99);
INSERT INTO Movie_series(movie_series_id, genre_id, creator_id, series_name, suggested_price)
VALUES(102, 2, 02, 'Toy Story', 22.13);
INSERT INTO Movie_series(movie_series_id, genre_id, creator_id, series_name, suggested_price)
VALUES(103, 1, 03, 'Lord of the Rings');
INSERT INTO Movie_series(movie_series_id, genre_id, creator_id, series_name, suggested_price)
VALUES(104, 3, 04, 'Love Story', 99.99);
INSERT INTO Movie_series(movie_series_id, genre_id, creator_id, series_name, suggested_price)
VALUES(105, 4, 04, 'Happy Moment', 88.88);

--Movie
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1001, 101, 'Episode I: The Phantom Menace', 136);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1002, 101, 'Episode II: Attack of the Clones', 142);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1003, 101, 'Episode III: Revenge of the Sith', 140);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1004, 101, 'Episode IV: A New Hope', 121);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1005, 102, 'Toy Story', 121);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1006, 102, 'Toy Story 2', 135);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1007, 102, 'Toy Story 3', 148);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1008, 103, 'The Lord of the Rings: The Fellowship of the Ring', 228);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1009, 103, 'The Lord of the Rings: The Two Towers', 235);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1010, 103, 'The Lord of the Rings: The Return of the King', 200);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1011, 104, 'Loving', 99);
INSERT INTO Movie(movie_id, movie_series_id, movie_name, length_in_minutes)
VALUES(1012, 105, 'Laughing', 88);


Step 2 – Counting Matches
